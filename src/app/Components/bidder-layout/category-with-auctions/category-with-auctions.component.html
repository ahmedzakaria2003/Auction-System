<div class="category-page">
 <app-nav-bar></app-nav-bar>

  <!-- Category Header -->
  <section class="category-header" *ngIf="category">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <h1 class="category-title">{{category.name}}</h1>
          <p class="category-description">استكشف مجموعة متنوعة من المزادات في {{category.name}}. ابدأ الآن وشارك في التجربة!</p>
        </div>
        <div class="col-lg-6">
          <div class="category-stats">
            <div class="stat-item"><span class="stat-value">{{category.pagedAuctions.count}}</span><span>مزادات</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="container">
      <div class="row">
    
        <div class="col-md-2">
       <input type="number" class="form-control"
       placeholder="السعر الأدنى"
       [(ngModel)]="minPrice"
       (input)="applyFilters()">
        </div>
        <div class="col-md-2">
          <input type="number" class="form-control"
       placeholder="السعر الأقصى"
       [(ngModel)]="maxPrice"
       (input)="applyFilters()">
        </div>
        <div class="col-md-2">
       <select class="form-select" [(ngModel)]="sortDirection" (change)="applyFilters()">
  <option value="">الترتيب</option>
  <option value="0">الاسم تصاعدي</option>
  <option value="1">الاسم تنازلي</option>
  <option value="2">السعر تصاعدي</option>
  <option value="3">السعر تنازلي</option>
</select>

        </div>
        <div class="col-md-2">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="endingSoon" [(ngModel)]="isEndingSoon" (change)="applyFilters()">
            <label class="form-check-label" for="endingSoon">تنتهي خلال 4 ساعات</label>
          </div>
        </div>
        <div class="col-md-2">
          <div class="search-box">
            <input type="text" class="form-control" placeholder="البحث..." [(ngModel)]="searchTerm" (input)="applyFilters()">
            <i class="fas fa-search search-icon"></i>
          </div>
        </div>
           <div class="col-md-2">
        <button class="btn btn-outline-secondary w-100" (click)="resetFilters()">
          <i class="fas fa-refresh me-2"></i>إعادة تعيين
        </button>
      </div>
      </div>
    </div>
  </div>

  <!-- Auctions Grid -->
  <section class="auctions-section">
    <div class="container">
      <div class="row">
        <div class="col-12" *ngIf="auctions.length === 0">
          <div class="alert alert-info text-center">لا يوجد مزادات متاحة بهذا الفلتر.</div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4" *ngFor="let auction of auctions">
          <div class="auction-card" (click)="viewAuctionDetails(auction.id)">
            <div class="card-image">
                <img [src]="(auction.thumbnailImage && auction.thumbnailImage) ? normalizeImageUrl(auction.thumbnailImage[0]) : ''"
                     alt="{{auction.title}}" class="img-thumbnail" *ngIf="auction.thumbnailImage && auction.thumbnailImage[0]">
                <span *ngIf="!auction.thumbnailImage || !auction.thumbnailImage[0]" class="text-muted">لا يوجد صورة</span>
              <div class="category-badge">{{auction.categoryName}}</div>
              <div class="hot-badge" *ngIf="isEndingSoon && getTimeRemainingForEndingSoon(auction.endTime) <= 4">
                <i class="fas fa-fire"></i> قريب الإنتهاء
              </div>
            </div>
            <div class="card-body">
              <h5 class="card-title">{{auction.title}}</h5>
              <div class="seller-info">
                <i class="fas fa-user me-2"></i>{{auction.sellerName}}
              </div>
              <div class="price-section">
                <span class="price-label">السعر الحالي</span>
                <span class="price-value">${{auction.startingPrice | number:'1.2-2'}}</span>
              </div>
              <div class="auction-stats">
                <div class="stat">
                  <i class="fas fa-hand-paper text-auction-gold"></i>
                  <strong>{{auction.bidsCount}} مزايدة</strong>
                </div>
<div class="stat remaining-time">
  <i class="fas fa-clock"></i>
  <span>{{ remainingTimeMap[auction.id] }}</span>
</div>

              </div>
              <button class="btn btn-auction w-100 mt-3">
                <i class="fas fa-gavel me-2"></i>شارك في المزاد
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Pagination -->
  <div class="pagination-container">
    <nav>
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="changePage(currentPage - 1)">السابق</a>
        </li>
        <li class="page-item" *ngFor="let page of getPageNumbers()" 
            [class.active]="page === currentPage">
          <a class="page-link" (click)="changePage(page)">{{page}}</a>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <a class="page-link" (click)="changePage(currentPage + 1)">التالي</a>
        </li>
      </ul>
    </nav>
  </div>

 <app-footer></app-footer>
</div>